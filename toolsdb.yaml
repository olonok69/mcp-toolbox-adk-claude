sources:
  my-bigquery-source:
    kind: bigquery
    project: complete-tube-421007
    location: eu
  my-bq-source:
    kind: bigquery
    project: complete-tube-421007
    location: us
tools:
  search-hotels-by-name:
    kind: bigquery-sql
    source: my-bigquery-source
    description: Search for hotels based on name.
    parameters:
      - name: name
        type: string
        description: The name of the hotel.
    statement: SELECT * FROM `test.hotels` WHERE LOWER(name) LIKE LOWER(CONCAT('%', @name, '%'));
  search-hotels-by-location:
    kind: bigquery-sql
    source: my-bigquery-source
    description: Search for hotels based on location.
    parameters:
      - name: location
        type: string
        description: The location of the hotel.
    statement: SELECT * FROM `test.hotels` WHERE LOWER(location) LIKE LOWER(CONCAT('%', @location, '%'));
  book-hotel:
    kind: bigquery-sql
    source: my-bigquery-source
    description: >-
       Book a hotel by its ID. If the hotel is successfully booked, returns a NULL, raises an error if not.
    parameters:
      - name: hotel_id
        type: integer
        description: The ID of the hotel to book.
    statement: UPDATE `test.hotels` SET booked = TRUE WHERE id = @hotel_id;
  update-hotel:
    kind: bigquery-sql
    source: my-bigquery-source
    description: >-
      Update a hotel's check-in and check-out dates by its ID. Returns a message indicating whether the hotel was successfully updated or not.
    parameters:
      - name: checkin_date
        type: string
        description: The new check-in date of the hotel.
      - name: checkout_date
        type: string
        description: The new check-out date of the hotel.
      - name: hotel_id
        type: integer
        description: The ID of the hotel to update.
    statement: >-
      UPDATE `test.hotels` SET checkin_date = PARSE_DATE('%Y-%m-%d', @checkin_date), checkout_date = PARSE_DATE('%Y-%m-%d', @checkout_date) WHERE id = @hotel_id;
  cancel-hotel:
    kind: bigquery-sql
    source: my-bigquery-source
    description: Cancel a hotel by its ID.
    parameters:
      - name: hotel_id
        type: integer
        description: The ID of the hotel to cancel.
    statement: UPDATE `test.hotels` SET booked = FALSE WHERE id = @hotel_id;
  search_release_notes_bq:
    kind: bigquery-sql
    source: my-bq-source
    parameters:
      - name: days_ago
        description: Number of days ago to look back for release notes.
        type: integer
    statement: |
      SELECT
      product_name,description,published_at
      FROM
        `bigquery-public-data`.`google_cloud_release_notes`.`release_notes`
      WHERE
      DATE(published_at) >= DATE_SUB(CURRENT_DATE(), INTERVAL @days_ago DAY)
      GROUP BY product_name,description,published_at
      ORDER BY published_at DESC
    description: |
      Use this tool to get information on Google Cloud Release Notes.
toolsets:
  my-toolset:
    - search-hotels-by-name
    - search-hotels-by-location
    - book-hotel
    - update-hotel
    - cancel-hotel
  my_bq_toolset:
    - search_release_notes_bq
